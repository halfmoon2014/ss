webpackJsonp([3],{Xxa5:function(a,t,e){a.exports=e("jyFz")},exGp:function(a,t,e){"use strict";t.__esModule=!0;var n,i=e("//Fk"),d=(n=i)&&n.__esModule?n:{default:n};t.default=function(a){return function(){var t=a.apply(this,arguments);return new d.default(function(a,e){return function n(i,s){try{var r=t[i](s),c=r.value}catch(a){return void e(a)}if(!r.done)return d.default.resolve(c).then(function(a){n("next",a)},function(a){n("throw",a)});a(c)}("next")})}}},jyFz:function(a,t,e){var n=function(){return this}()||Function("return this")(),i=n.regeneratorRuntime&&Object.getOwnPropertyNames(n).indexOf("regeneratorRuntime")>=0,d=i&&n.regeneratorRuntime;if(n.regeneratorRuntime=void 0,a.exports=e("SldL"),i)n.regeneratorRuntime=d;else try{delete n.regeneratorRuntime}catch(a){n.regeneratorRuntime=void 0}},mPn4:function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=e("//Fk"),i=e.n(n),d=e("Xxa5"),s=e.n(d),r=e("exGp"),c=e.n(r),l=e("F3vo"),o=e("Fd2+"),m=e("KvKp"),h={name:"FactoryWash",components:{FieldPickerSingle:function(){return e.e(10).then(e.bind(null,"QkLz"))},PickerSingle:function(){return e.e(0).then(e.bind(null,"1bf3"))},PopupRowCol:function(){return e.e(11).then(e.bind(null,"cOc4"))},VanButton:o.a,VanTabbar:o.s,VanTabbarItem:o.t,VanCollapse:o.g,VanCollapseItem:o.h,VanField:o.j,VanPopup:o.p,VanCol:o.f,VanRow:o.q,VanIcon:o.k,VanDivider:o.i},data:function(){return{active:"",activeNames:[0],mdata:{cmzbid:0,gzh:"",lymxid:0,htdjlx:0,djid:0,syid:"",wtsid:"",flowcs:"",yplbGuid:Object(m.b)(),xzcmGuid:Object(m.b)(),yplbDisabled:!0,sphhModel:!1,yplb:0,yplbDS:[{dm:1,mc:"产前封样"},{dm:2,mc:"预投封样"},{dm:3,mc:"测试封样"},{dm:4,mc:"大货"}],xdcx:0,xdcxDS:[{dm:0,mc:"标准洗"},{dm:1,mc:"快洗"},{dm:2,mc:"干洗"}],xdcs:0,xdcsDS:[{dm:1,mc:"机洗1遍"},{dm:3,mc:"机洗3遍"},{dm:5,mc:"机洗5遍"}],xzcm:"",xzcmDS:[],sphh:"",sphhHidden:"",khmc:"",khid:0,ddsl:"",xzyj:"",shyj:"",ldxzyj:"",ldshyj:"",bwDetail:[],sysDetail:[]},loading:!1,scanVisible:!0,userid:l.a.userInfo.userid}},methods:{init:function(){var a,t=this;0==this.mdata.djid&&(this.mdata.djid=Object(m.a)("MyDJid",window.location.href)||0),this.mdata.djid&&(this.loading=!0,this.initPromise(this.mdata.djid).then((a=c()(s.a.mark(function a(e){var n,i,d,r;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(0==e.errcode){a.next=4;break}return t.errMsg(e.errmsg),t.loading=!1,a.abrupt("return");case 4:return t.mdata.sphh=e.data[0][0].sphh,t.mdata.sphhHidden=e.data[0][0].sphh,t.mdata.khmc=e.data[0][0].khmc,t.mdata.xdcx=e.data[0][0].xdcx,t.mdata.xdcs=e.data[0][0].xdcs,t.mdata.ddsl=e.data[0][0].ddsl,t.mdata.wtsid=e.data[0][0].wtsid,t.mdata.syid=e.data[0][0].syid,t.mdata.xzyj=e.data[0][0].xzyj,t.mdata.shyj=e.data[0][0].shyj,t.mdata.ldxzyj=e.data[0][0].ldxzyj,t.mdata.ldshyj=e.data[0][0].ldshyj,t.mdata.flowcs=e.data[0][0].flowcs||"",t.mdata.sysDetail.splice(0,t.mdata.sysDetail.length),t.mdata.yplb=e.data[0][0].yplb,a.next=21,t.yplbPromise();case 21:for(t.mdata.xzcm=e.data[2][0].dm,t.mdata.bwDetail.splice(0,t.mdata.bwDetail.length),n=0;n<e.data[2].length;n++)t.mdata.bwDetail.push({dm:e.data[2][n].dm,mc:e.data[2][n].mc,ypkh:e.data[2][n].ypkh,bzcc:e.data[2][n].bzcc,xqcc:e.data[2][n].xqcc,xhcc:e.data[2][n].xhcc});for(n=0;n<e.data[1].length;n++){if(i=e.data[1][n].kxz){for(d=[],r=0;r<i.split("/").length;r++)d.push({dm:i.split("/")[r],mc:i.split("/")[r]});e.data[1][n].kxzList=d}t.mdata.sysDetail.push({bjdmxid:e.data[1][n].bjdmxid,mc:e.data[1][n].mc,bsbzz:e.data[1][n].bsbzz,kxz:e.data[1][n].kxz,kxzList:e.data[1][n].kxzList,jcjg:e.data[1][n].jcjg,pdjg:e.data[1][n].pdjg})}t.mdata.cmzbid=e.data[2][0].id,t.loading=!1;case 27:case"end":return a.stop()}},a,t)})),function(t){return a.apply(this,arguments)})).catch(function(a){t.errMsg(a),t.loading=!1}))},pickerSingleBack:function(a,t,e){this.loading=!0,a==this.mdata.yplbGuid&&this.yplbPromise(),a==this.mdata.xzcmGuid&&this.xzcmPromise()},yplbPromise:function(){var a=this;return new i.a(function(t,e){a.$axios.get(APIUTL,{params:{serviceName:"svr-external",action:"factoryWash/cmList",sphh:a.mdata.sphh,yplb:a.mdata.yplb}}).then(function(e){var n=e.data;if(0!=n.errcode)return a.errMsg(n.errmsg),void(a.loading=!1);a.loading=!1,a.mdata.xzcmDS.splice(0,a.mdata.xzcmDS.length);for(var i=0;i<=n.data.length;i++)n.data[i]&&a.mdata.xzcmDS.push({dm:n.data[i].dm,mc:n.data[i].cm});a.mdata.xzcm="",a.mdata.bwDetail.splice(0,a.mdata.bwDetail.length),t(e.data)}).catch(function(t){a.errMsg(t),e(t)})})},sysDetailPromise:function(a){var t=this;return new i.a(function(e,n){t.$axios.get(APIUTL,{params:{serviceName:"svr-external",action:"factoryWash/jcxm",splbid:a}}).then(function(a){e(a.data)}).catch(function(a){n(a)})})},xzcmPromise:function(){var a=this;return new i.a(function(t,e){a.$axios.get(APIUTL,{params:{serviceName:"svr-external",action:"factoryWash/bzcm",sphh:a.mdata.sphh,yplb:a.mdata.yplb,xzcm:a.mdata.xzcm}}).then(function(e){var n=e.data;if(0!=n.errcode)return a.errMsg(n.errmsg),void(a.loading=!1);a.mdata.bwDetail=n.data,a.loading=!1,t(e.data)}).catch(function(t){a.errMsg(t),e(t)})})},initPromise:function(a){var t=this;return new i.a(function(e,n){t.$axios.get(APIUTL,{params:{serviceName:"svr-external",action:"factoryWash/"+a}}).then(function(a){e(a.data)}).catch(function(a){n(a)})})},handleSelect:function(a){"save"==a&&this.save()},save:function(){var a=this;if(this.mdata.sphh!=this.mdata.sphhHidden)return this.errMsg("请查询货号信息"),void(this.active="");if(0==this.mdata.xzcm.length)return this.errMsg("请选择尺码"),void(this.active="");for(var t=0;t<this.mdata.bwDetail.length;t++){if(0==this.mdata.bwDetail[t].xqcc.length)return this.errMsg("请填写洗前尺寸"),void(this.active="");if(0==this.mdata.bwDetail[t].xhcc.length)return this.errMsg("请填写洗后尺寸"),void(this.active="")}for(t=0;t<this.mdata.sysDetail.length;t++)if(0==this.mdata.sysDetail[t].jcjg.length)return this.errMsg("请填写测试结果"),void(this.active="");var e=this.mdata;e.userssid=1,e.username=l.a.userInfo.cname,e.userid=this.userid;var n=[];e.jcjg=n;for(t=0;t<this.mdata.sysDetail.length;t++)n.push({id:this.mdata.sysDetail[t].testid,jcjg:this.mdata.sysDetail[t].jcjg,pdjg:this.mdata.sysDetail[t].pdjg,bjdmxid:this.mdata.sysDetail[t].bjdmxid||0});var i=[];e.cmjg=i;for(t=0;t<this.mdata.bwDetail.length;t++)i.push({cmdm:this.mdata.bwDetail[t].dm,cmmc:this.mdata.bwDetail[t].mc,ypkh:this.mdata.bwDetail[t].ypkh,xqcc:this.mdata.bwDetail[t].xqcc,xhcc:this.mdata.bwDetail[t].xhcc,bzcc:this.mdata.bwDetail[t].bzcc});this.savePromise(e).then(function(t){0==t.errcode?(a.$message("保存成功"),a.mdata.djid=t.data[0].djid,a.goflowPromise(a.mdata.djid).then(function(t){0==t.errcode||a.errMsg(t.errmsg)}).catch(function(a){})):a.errMsg(t.errmsg),a.active=""}).catch(function(t){a.active=""})},savePromise:function(a){var t=this;return new i.a(function(e,n){t.$axiosPost.post(APIUTL+"?serviceName=svr-external&action=factoryWash",a).then(function(a){e(a.data)}).catch(function(a){n(a)})})},errMsg:function(a){this.$message({showClose:!0,message:a,type:"error"})},popupRowColBack:function(a,t,e){var n=this;if("fwsphh"==a){if(this.mdata.sphhModel=!1,e.errcode>0)return this.$message(e.errmsg),this.mdata.yplbDisabled=!0,!1;this.mdata.sphh=e.sphh,this.mdata.sphhHidden=e.sphh,this.mdata.khmc=e.khmc,this.mdata.gzh=e.gzh,this.mdata.khid=e.khid,this.mdata.ddsl=e.ddsl,this.mdata.lymxid=e.mxid,this.mdata.htdjlx=e.htdjlx,this.mdata.yplbDisabled=!1,this.mdata.yplb=0,this.mdata.xzcmDS.splice(0,this.mdata.xzcmDS.length),this.mdata.xzcm="",this.mdata.bwDetail.splice(0,this.mdata.bwDetail.length),this.loading=!0,this.sysDetailPromise(e.splbid).then(function(a){if(0!=a.errcode)return n.errMsg(a.errmsg),void(n.loading=!1);n.loading=!1,n.mdata.sysDetail.splice(0,n.mdata.sysDetail.length);for(var t=0;t<a.data.length;t++){var e=a.data[t].kxz;if(e){for(var i=[],d=0;d<e.split("/").length;d++)i.push({dm:e.split("/")[d],mc:e.split("/")[d]});a.data[t].kxzList=i}}n.mdata.sysDetail=a.data}).catch(function(a){n.errMsg(a),n.loading=!1})}},goflowPromise:function(a){var t=this;return new i.a(function(e,n){t.$axios.get(APIUTL,{params:{serviceName:"svr-external",action:"getFlowConfig",id:a,tableName:"Yf_T_bjdlb-factoryWash"}}).then(function(a){var n=a.data;if(0!=n.errcode)return t.errMsg(n.errmsg),t.loading=!1,void t.init();if(t.loading=!1,1==n.data.isneed){var i="http://sj.lilang.com:186/llsj/docDetailDataFF.aspx?";for(var d in n.data)"tzid"!=d&&"docid"!=d&&"dxid"!=d&&"flowid"!=d&&"dbname"!=d&&"cname"!=d&&"userid"!=d||(i=-1===i.indexOf("?")?i+"?"+d+"="+n.data[d]:i+"&"+d+"="+n.data[d]);i+="&gourl="+encodeURIComponent("http://tm.lilanz.com/oa/project/LabDev/index.html#/FActoryWash?apptoken="+l.a.userInfo.apptoken),console.log(window.location.href),window.location.href=i}else t.init();e(a.data)}).catch(function(a){t.errMsg(a),t.init(),n(a)})})}},mounted:function(){},watch:{},computed:{},created:function(){llApp.init(),this.init()}},u={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"wrap"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"},{name:"show",rawName:"v-show",value:a.scanVisible,expression:"scanVisible"}],staticStyle:{"margin-left":"10px","margin-right":"10px","margin-top":"10px"}},[e("van-divider",{style:{color:"#1989fa",borderColor:"#1989fa",padding:"0 16px"},attrs:{"content-position":"left"}},[a._v("订单信息")]),a._v(" "),a.mdata.sphhModel?e("PopupRowCol",{attrs:{type:"fwsphh",inExtObj:{sphh:a.mdata.sphh,userid:a.userid}},on:{goback:a.popupRowColBack}}):a._e(),a._v(" "),e("van-cell-group",[e("van-field",{attrs:{label:"货号",placeholder:"请输入"},scopedSlots:a._u([{key:"button",fn:function(){return[e("van-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){a.mdata.sphhModel=!0}}},[a._v("查询")])]},proxy:!0}]),model:{value:a.mdata.sphh,callback:function(t){a.$set(a.mdata,"sphh",t)},expression:"mdata.sphh"}}),a._v(" "),e("van-field",{attrs:{readonly:"",label:"工厂"},model:{value:a.mdata.khmc,callback:function(t){a.$set(a.mdata,"khmc",t)},expression:"mdata.khmc"}}),a._v(" "),e("van-field",{attrs:{type:"number",readonly:"",label:"订单数量"},model:{value:a.mdata.ddsl,callback:function(t){a.$set(a.mdata,"ddsl",t)},expression:"mdata.ddsl"}}),a._v(" "),e("FieldPickerSingle",{attrs:{title:"样品类别",placeholder:a.mdata.yplbDisabled?"请输入货号":"请选择",inValue:a.mdata.yplb,dataSource:a.mdata.yplbDS,type:a.mdata.yplbGuid,inExtObj:{disabled:a.mdata.yplbDisabled}},on:{"update:inValue":function(t){return a.$set(a.mdata,"yplb",t)},"update:in-value":function(t){return a.$set(a.mdata,"yplb",t)},goback:a.pickerSingleBack}}),a._v(" "),e("FieldPickerSingle",{attrs:{title:"洗涤程序",placeholder:"请选择",inValue:a.mdata.xdcx,dataSource:a.mdata.xdcxDS},on:{"update:inValue":function(t){return a.$set(a.mdata,"xdcx",t)},"update:in-value":function(t){return a.$set(a.mdata,"xdcx",t)},goback:a.pickerSingleBack}}),a._v(" "),e("FieldPickerSingle",{attrs:{title:"洗涤次数",placeholder:"请选择",inValue:a.mdata.xdcs,dataSource:a.mdata.xdcsDS},on:{"update:inValue":function(t){return a.$set(a.mdata,"xdcs",t)},"update:in-value":function(t){return a.$set(a.mdata,"xdcs",t)}}}),a._v(" "),e("FieldPickerSingle",{attrs:{title:"选择尺码",placeholder:"请选择",inValue:a.mdata.xzcm,dataSource:a.mdata.xzcmDS,type:a.mdata.xzcmGuid},on:{"update:inValue":function(t){return a.$set(a.mdata,"xzcm",t)},"update:in-value":function(t){return a.$set(a.mdata,"xzcm",t)},goback:a.pickerSingleBack}}),a._v(" "),e("van-divider",{style:{color:"#1989fa",borderColor:"#1989fa",padding:"0 16px"},attrs:{"content-position":"left"}},[a._v("尺寸")]),a._v(" "),e("van-row",{staticStyle:{"font-weight":"800"}},[e("van-col",{attrs:{span:"4"}},[a._v("部位")]),a._v(" "),e("van-col",{attrs:{span:"5"}},[a._v("标准尺寸")]),a._v(" "),e("van-col",{attrs:{span:"5"}},[a._v("洗前尺寸")]),a._v(" "),e("van-col",{attrs:{span:"5"}},[a._v("洗后尺寸")]),a._v(" "),e("van-col",{attrs:{span:"5"}},[a._v("百分比")])],1),a._v(" "),a._l(a.mdata.bwDetail,function(t,n){return e("van-row",{key:n,attrs:{type:"flex",name:n,align:"center"}},[e("van-col",{attrs:{span:"4"}},[a._v(a._s(t.mc))]),a._v(" "),e("van-col",{attrs:{span:"5"}},[a._v(a._s(t.bzcc))]),a._v(" "),e("van-col",{attrs:{span:"5"}},[e("van-field",{attrs:{type:"number",placeholder:"请输入"},model:{value:t.xqcc,callback:function(e){a.$set(t,"xqcc",e)},expression:"item.xqcc"}})],1),a._v(" "),e("van-col",{attrs:{span:"5"}},[e("van-field",{attrs:{type:"number",placeholder:"请输入"},model:{value:t.xhcc,callback:function(e){a.$set(t,"xhcc",e)},expression:"item.xhcc"}})],1),a._v(" "),e("van-col",{attrs:{span:"5"}},[a._v(a._s(Math.round(100*(t.xhcc-t.xqcc)/t.xqcc,2))+"%")])],1)}),a._v(" "),e("van-divider",{style:{color:"#1989fa",borderColor:"#1989fa",padding:"0 16px"},attrs:{"content-position":"left"}},[a._v("测试结果")]),a._v(" "),a._l(a.mdata.sysDetail,function(t,n){return e("div",{key:t.mc,attrs:{name:n}},[e("div",{staticClass:"van-doc-block__card"},[e("van-row",[e("van-col",{attrs:{span:"14"}},[a._v(a._s(t.mc))]),a._v(" "),e("van-col",{attrs:{span:"10"}},[a._v(a._s(t.bsbzz))])],1),a._v(" "),e("van-row",[e("van-col",{attrs:{span:"18"}},[t.kxz.length>0?e("FieldPickerSingle",{attrs:{placeholder:"请选择",inValue:t.jcjg,dataSource:t.kxzList,inExtObj:{labelHidden:!0}},on:{"update:inValue":function(e){return a.$set(t,"jcjg",e)},"update:in-value":function(e){return a.$set(t,"jcjg",e)}}}):e("van-field",{attrs:{rows:"1",autosize:"",type:"textarea",placeholder:"测试结果"},model:{value:t.jcjg,callback:function(e){a.$set(t,"jcjg",e)},expression:"item.jcjg"}})],1),a._v(" "),e("van-col",{attrs:{span:"6"}},[a.mdata.flowcs.length>0?e("FieldPickerSingle",{attrs:{title:"判定结果",placeholder:"请选择",inValue:t.pdjg,dataSource:[{dm:"合格",mc:"合格"},{dm:"不合格",mc:"不合格"}],inExtObj:{labelHidden:!0}},on:{"update:inValue":function(e){return a.$set(t,"pdjg",e)},"update:in-value":function(e){return a.$set(t,"pdjg",e)}}}):e("van-field",{attrs:{rows:"1",readonly:"",autosize:"",type:"textarea",placeholder:"判定结果"},model:{value:t.pdjg,callback:function(e){a.$set(t,"pdjg",e)},expression:"item.pdjg"}})],1)],1)],1)])}),a._v(" "),e("van-divider",{directives:[{name:"show",rawName:"v-show",value:a.mdata.flowcs.length>0,expression:"mdata.flowcs.length > 0"}],style:{color:"#1989fa",borderColor:"#1989fa",padding:"0 16px"},attrs:{"content-position":"left"}},[a._v("审批意见")]),a._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:a.mdata.flowcs.length>0,expression:"mdata.flowcs.length > 0"}],staticClass:"van-doc-block__card"},[e("van-row",[e("van-col",{attrs:{span:"14"}},[a._v("QA工程师审核意见")]),a._v(" "),e("van-col",{attrs:{span:"10"}},[e("FieldPickerSingle",{attrs:{title:"意见",placeholder:"请选择",inValue:a.mdata.xzyj,dataSource:[{dm:"合格",mc:"合格"},{dm:"不合格",mc:"不合格"},{dm:"让步接收",mc:"让步接收"},{dm:"评审接受",mc:"评审接受"}],inExtObj:{labelHidden:!0}},on:{"update:inValue":function(t){return a.$set(a.mdata,"xzyj",t)},"update:in-value":function(t){return a.$set(a.mdata,"xzyj",t)}}})],1)],1),a._v(" "),e("van-row",[e("van-col",{attrs:{span:"24"}},[e("van-field",{attrs:{rows:"1",autosize:"",type:"textarea",placeholder:"请输入"},model:{value:a.mdata.shyj,callback:function(t){a.$set(a.mdata,"shyj",t)},expression:"mdata.shyj"}})],1)],1)],1),a._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:a.mdata.flowcs.length>0,expression:"mdata.flowcs.length > 0"}],staticClass:"van-doc-block__card"},[e("van-row",[e("van-col",{attrs:{span:"14"}},[a._v("商品调控中心分管品质副总监意见")]),a._v(" "),e("van-col",{attrs:{span:"10"}},[e("FieldPickerSingle",{attrs:{title:"意见",placeholder:"请选择",inValue:a.mdata.ldxzyj,dataSource:[{dm:"合格",mc:"合格"},{dm:"不合格",mc:"不合格"},{dm:"让步接收",mc:"让步接收"},{dm:"评审接受",mc:"评审接受"}],inExtObj:{labelHidden:!0}},on:{"update:inValue":function(t){return a.$set(a.mdata,"ldxzyj",t)},"update:in-value":function(t){return a.$set(a.mdata,"ldxzyj",t)}}})],1)],1),a._v(" "),e("van-row",[e("van-col",{attrs:{span:"24"}},[e("van-field",{attrs:{rows:"1",autosize:"",type:"textarea",placeholder:"请输入"},model:{value:a.mdata.ldshyj,callback:function(t){a.$set(a.mdata,"ldshyj",t)},expression:"mdata.ldshyj"}})],1)],1)],1)],2)],1),a._v(" "),e("van-tabbar",{on:{change:a.handleSelect},model:{value:a.active,callback:function(t){a.active=t},expression:"active"}},[e("van-tabbar-item",{attrs:{name:"save",icon:"certificate"}},[a._v("保存")]),a._v(" "),e("van-tabbar-item",{attrs:{name:"send",icon:"sign"}},[a._v("办理")])],1)],1)},staticRenderFns:[]};var p=e("VU/8")(h,u,!1,function(a){e("niNG")},"data-v-17507961",null);t.default=p.exports},niNG:function(a,t){}});
//# sourceMappingURL=3.b0049bfb8480c12c475a.js.map